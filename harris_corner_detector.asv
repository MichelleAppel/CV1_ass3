function [ H, r, c ] = harris_corner_detector(image, window_size)
image = rgb2gray(image);
[ Gx, Gy ] = imgradientxy(image);

[ h, w ] = size(image);
Q = zeros(h, w, 2, 2);

A = imgaussfilt(Gx.^2, 1);  % A
B = imgaussfilt(Gx.*Gy, 1); % B
Q(:, :, 2, 1) = imgaussfilt(Gx.*Gy, 1); % B
C = imgaussfilt(Gy.^2, 1);  % C

H = zeros(h, w);
H(:, :) = (Q(:, :, 1, 1) .* Q(:, :, 2, 2) - Q(:, :, 1, 2).^2) ...
    - 0.04 * (Q(:, :, 1, 1) + Q(:, :, 2, 2)).^2;



end